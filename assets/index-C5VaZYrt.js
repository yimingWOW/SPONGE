import{r as g,P as re,j as e,C as ce,W as ie,a as le,c as de,u as O,b as C,d as K,O as me,g as G,N as ue,T as pe,S as E,L as he,e as fe,f as y,h as v,A as w,i as P,k as h,l as x,m as H,n as J,o as N,B as Z,p as B,q as I,s as X,t as Q,v as z,w as ge,x as xe,y as ke,R as ye,H as ve}from"./vendor-Cj4Bv78W.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(n){if(n.ep)return;n.ep=!0;const t=o(n);fetch(n.href,t)}})();const Y=g.createContext({network:"localnet",setNetwork:()=>{}}),Ae=()=>g.useContext(Y),be={"mainnet-beta":de("mainnet-beta"),devnet:"https://greatest-tiniest-mansion.solana-devnet.quiknode.pro/a65e3540c3a32f0f22ed654ea1df784f0a471f51/",localnet:"http://127.0.0.1:8899"},Ne=({onChange:a,value:r})=>e.jsx("div",{className:"solana-network-select-container",children:e.jsxs("select",{onChange:o=>a(o.target.value),value:r,className:"solana-network-select",children:[e.jsx("option",{value:"devnet",children:"Devnet"}),e.jsx("option",{value:"localnet",children:"Localnet"}),e.jsx("option",{value:"mainnet-beta",children:"Mainnet"})]})}),je=({children:a})=>{const[r,o]=g.useState("devnet"),s=g.useMemo(()=>be[r],[r]),n=g.useMemo(()=>[new re],[]);return e.jsx(Y.Provider,{value:{network:r,setNetwork:o},children:e.jsx(ce,{endpoint:s,children:e.jsx(ie,{wallets:n,autoConnect:!0,children:e.jsx(le,{children:a})})})})},we="G2bMcD1FhZb5sJ6X3vA6k9hyRmZa8NEtq6LsRb6WVyRN",Pe={name:"cash",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},Se=[{name:"create_amm",discriminator:[242,91,21,170,5,68,125,64],accounts:[{name:"amm",writable:!0,pda:{seeds:[{kind:"arg",path:"id"}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"id",type:"pubkey"}]},{name:"create_cash_pool",discriminator:[251,107,117,98,219,201,139,87],accounts:[{name:"amm",pda:{seeds:[{kind:"account",path:"amm.id",account:"Amm"}]}},{name:"mint_a"},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"cash_pool",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[97]}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"create_pool_1",discriminator:[65,185,40,205,113,45,173,179],accounts:[{name:"amm",pda:{seeds:[{kind:"account",path:"amm.id",account:"Amm"}]}},{name:"mint_a"},{name:"pool",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[97]}]}},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"mint_a"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[101]}]}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[103]}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"lend",discriminator:[89,34,75,168,122,47,185,45],accounts:[{name:"pool",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[101]}]}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"lender",signer:!0},{name:"lender_token_a",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_authority",pda:{seeds:[{kind:"account",path:"pool"},{kind:"account",path:"lender"},{kind:"const",value:[97]}]}},{name:"lender_lend_receipt_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"lending_receipt_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",docs:["The account paying for all rents"],writable:!0,signer:!0},{name:"token_program",docs:["Solana ecosystem accounts"],address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"user_lending_amount",type:"u64"}]},{name:"lend_cash",discriminator:[11,66,11,107,38,72,149,243],accounts:[{name:"mint_a"},{name:"cash_pool",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_cash",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"mint_a"},{kind:"const",value:[103]}]}},{name:"lender",signer:!0},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_scash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"s_cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",docs:["The account paying for all rents"],writable:!0,signer:!0},{name:"token_program",docs:["Solana ecosystem accounts"],address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"user_lending_amount",type:"u64"}]},{name:"redeem",discriminator:[184,12,86,149,70,196,97,225],accounts:[{name:"pool",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"mint_a"},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[101]}]}},{name:"lender",signer:!0},{name:"lender_token_a",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"mint_a"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_authority",pda:{seeds:[{kind:"account",path:"pool"},{kind:"account",path:"lender"},{kind:"const",value:[97]}]}},{name:"lender_lend_receipt_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"lending_receipt_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"redeem_cash",discriminator:[58,207,171,57,139,103,200,20],accounts:[{name:"cash_pool",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_cash",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[103]}]}},{name:"lender",signer:!0},{name:"lender_authority",pda:{seeds:[{kind:"account",path:"cash_pool"},{kind:"account",path:"lender"},{kind:"const",value:[97]}]}},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_scash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"s_cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]}],_e=[{name:"Amm",discriminator:[143,245,200,17,74,214,196,135]},{name:"Pool",discriminator:[241,154,109,4,17,177,109,188]}],Ce=[{code:6e3,name:"CalculationError",msg:"Calculation error"}],Ee=[{name:"Amm",type:{kind:"struct",fields:[{name:"id",docs:["Primary key of the AMM"],type:"pubkey"},{name:"admin",docs:["Account that has admin authority over the AMM"],type:"pubkey"},{name:"liquidity_fee",docs:["liquidity fee percentage: 100000 = 100%"],type:"u16"},{name:"protocol_fee_percentage",docs:["Protocol fee percentage of the liquidity fee (0-100)","e.g., 10000 means 100% of liquidity fee goes to protocol"],type:"u16"}]}},{name:"Pool",type:{kind:"struct",fields:[{name:"amm",docs:["Primary key of the AMM"],type:"pubkey"},{name:"mint_a",docs:["Mint of token A"],type:"pubkey"},{name:"token_a_amount",docs:["借贷池中token a的数量"],type:"u64"},{name:"token_b_amount",docs:["借贷池中token b的数量"],type:"u64"},{name:"pool_type",type:"u64"}]}}],Te=[{name:"AUTHORITY_SEED",type:"bytes",value:"[97]"},{name:"CASH_POOL",type:"bytes",value:"[98]"},{name:"CASH_TOKEN_SEED",type:"bytes",value:"[102]"},{name:"LENDING_TOKEN_SEED",type:"bytes",value:"[101]"},{name:"SCASH_TOKEN_SEED",type:"bytes",value:"[103]"}],S={address:we,metadata:Pe,instructions:Se,accounts:_e,errors:Ce,types:Ee,constants:Te},j="a",Be="b",F="e",T="f",D="g",Ie="GUXNPX5ci1Qj76MZe2aRJ33zK48VmT6gXVyR86CsF4T5",q="EisXsrG1aCoaJTFSDdXTBRAEAZP46wPWkKJpF7RfC3DV",L=({isActive:a,onClick:r,icon:o,label:s})=>e.jsx("button",{className:`tab-button ${a?"active":""}`,onClick:r,children:e.jsxs("div",{className:"section-title",children:[o,s]})}),Le=()=>{const{publicKey:a}=O(),r=C(),s=K().pathname.split("/")[1]||"guide",n=t=>{r(`/${t}`)};return e.jsxs("div",{className:"dashboard",children:[e.jsxs("nav",{className:"tab-nav",children:[(a==null?void 0:a.toBase58())===Ie&&e.jsx(L,{isActive:s==="amm",onClick:()=>n("amm"),icon:"⚙️",label:"AMM"}),e.jsx(L,{isActive:s==="introduction",onClick:()=>n("introduction"),icon:"📖",label:"Introduction"}),e.jsx(L,{isActive:s==="guide",onClick:()=>n("guide"),icon:"📚",label:"Guide"}),e.jsx(L,{isActive:s==="cash",onClick:()=>n("cash"),icon:"💰",label:"Cash"}),e.jsx(L,{isActive:s==="scash",onClick:()=>n("scash"),icon:"💰",label:"Scash"})]}),e.jsx("div",{className:"dashboard-content",children:e.jsx(me,{})})]})};async function De(a,r,o){try{const s=await G(ue,r.publicKey),n=new pe;n.add(E.transfer({fromPubkey:r.publicKey,toPubkey:s,lamports:o*he})),n.add(fe(s));const t=await a.getLatestBlockhash();n.recentBlockhash=t.blockhash,n.feePayer=r.publicKey;const c=await r.signTransaction(n),i=await a.sendRawTransaction(c.serialize());return await a.confirmTransaction({signature:i,...t}),i}catch(s){throw console.error("Error wrapping SOL:",s),s}}const Me=({onSuccess:a})=>{const r=y(),{connection:o}=v(),[s,n]=g.useState(""),[t,c]=g.useState(!1),[i,d]=g.useState(""),m=async f=>{if(f.preventDefault(),n(""),c(!0),!r){n("Please connect your wallet first"),c(!1);return}if(!i||isNaN(Number(i))||Number(i)<=0){n("Please enter a valid amount"),c(!1);return}try{const p=await De(o,r,Number(i));console.log(`Transaction URL: https://explorer.solana.com/tx/${p}`),a(p),d("")}catch(p){console.error("Error wrapping SOL:",p),n(p instanceof Error?p.message:"Failed to wrap SOL")}finally{c(!1)}};return e.jsxs("div",{className:"wrapper",children:[s&&e.jsx("div",{className:"secondary-text",style:{color:"var(--error)"},children:s}),e.jsxs("form",{onSubmit:m,children:[e.jsx("div",{style:{marginBottom:"var(--spacing-md)"},children:e.jsx("input",{type:"number",value:i,onChange:f=>d(f.target.value),placeholder:"Enter SOL amount",step:"any",min:"0",className:"input-field",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid var(--border-color)"}})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:t||!r||!i,children:t?"Processing...":"Wrap SOL"})})]})]})},Oe="/SPONGE/assets/guide_pic_1-BISUfyi8.png",U=()=>e.jsxs("div",{className:"card-container",children:[e.jsx("h1",{className:"title",children:"Getting Started with SPONGE Protocol"}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Prerequisites"}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"1. Enable Devnet in Phantom Wallet"}),e.jsx("p",{children:"Open Phantom wallet settings → Developer Settings → Open Testnet Mode"}),e.jsx("img",{src:Oe,alt:"Enable Devnet in Phantom",className:"guide-image"})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"2. Get Devnet Token"}),e.jsxs("p",{children:["Obtain Devnet SOL from the ",e.jsx("a",{className:"text-link",href:"https://faucet.solana.com/",target:"_blank",rel:"noopener noreferrer",children:"Solana Faucet"})]}),e.jsxs("p",{children:["Obtain Devnet USDT tokens from the ",e.jsx("a",{className:"text-link",href:"https://spl-token-faucet.com/?token-name=USDT",target:"_blank",rel:"noopener noreferrer",children:"SPL Token Faucet"})]})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"3. Convert SOL to WSOL for trading in Wsol-USDT Pool"}),e.jsx(Me,{onSuccess:()=>{}})]})]}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Using the Protocol"}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"1. Connect Your Wallet"}),e.jsx("p",{children:'Use the "Connect Wallet" button in the top right corner'})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"2. Deposit SOL"}),e.jsx("p",{children:"You can deposit SOL into the pool and get $cash"})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"3. Withdraw SOL"}),e.jsx("p",{children:"You can withdraw SOL and repay the $cash"})]})]})]}),Fe=async(a,r)=>{console.log("Getting AMM accounts connection:",r);const o=new w(r,a,{preflightCommitment:"confirmed"}),n=await new P(S,o).account.amm.all();for(const t of n)console.log("AMM Account Details:",{publicKey:t.publicKey.toString(),id:t.account.id.toString(),admin:t.account.admin.toString()});return n.map(t=>({pubkey:t.publicKey.toString(),ammid:t.account.id.toString(),admin:t.account.admin.toString()}))},ee=g.createContext(void 0),We=({children:a})=>{const r=y(),{connection:o}=v(),[s,n]=g.useState(null),[t,c]=g.useState([]),[i,d]=g.useState(!1),[m,f]=g.useState(null),p=u=>{console.log("Selected AMM:",u.pubkey),n(u)},l=async()=>{if(r){d(!0),f(null);try{const u=await Fe(r,o);console.log("Fetched AMM accounts:",u),c(u),u.length>0&&!s&&p(u[0])}catch(u){console.error("Error fetching AMMs:",u),f(u instanceof Error?u.message:"Failed to fetch AMMs")}finally{d(!1)}}};return g.useEffect(()=>{l()},[r,o]),e.jsx(ee.Provider,{value:{amm:s,amms:t,setAmm:n,selectAmm:p,isLoading:i,error:m,refreshAmms:l},children:a})},R=()=>{const a=g.useContext(ee);if(!a)throw new Error("useAmm must be used within an AmmProvider");return a};async function Ke(a,r,o){try{const s=new w(r,a,{preflightCommitment:"confirmed"}),n=new P(S,s),[t]=h.findProgramAddressSync([o.toBuffer()],n.programId);return await n.methods.createAmm(o).accounts({amm:t,admin:q,payer:s.wallet.publicKey,systemProgram:E.programId}).rpc()}catch(s){throw console.error("Error details:",s),s}}const Ge=()=>{const a=y(),{connection:r}=v(),[o,s]=g.useState(""),[n,t]=g.useState("500"),[c,i]=g.useState(!1),[d,m]=g.useState(""),f=async p=>{if(p.preventDefault(),s(""),i(!0),!a){s("Please connect your wallet first"),i(!1);return}const l=Number(n);if(l<1||l>1e4){s("Fee must be between 1 and 10000"),i(!1);return}try{const u=h.unique(),k=await Ke(a,r,u);console.log(`Transaction URL: https://explorer.solana.com/tx/${k}`),m(u.toString()),t("500")}catch(u){console.error("Error creating AMM:",u),s(u instanceof Error?u.message:"Failed to create AMM. Please try again.")}finally{i(!1)}};return e.jsxs("div",{className:"create-amm-container",children:[o&&e.jsx("div",{className:"error-message",children:o}),d&&e.jsxs("div",{className:"success-message",children:["AMM created successfully! ID: ",d]}),e.jsx("form",{onSubmit:f,className:"form",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!a,children:c?"Creating...":"Create AMM"})})]})},qe=()=>{const{amms:a,selectAmm:r,isLoading:o,error:s}=R();return e.jsxs("div",{className:"tap-page",children:[e.jsx("h2",{children:"Existing AMMs"}),s&&e.jsx("div",{className:"error-message",children:s}),o?e.jsx("div",{children:"Loading AMMs..."}):a.length===0?e.jsx("div",{className:"card-container",children:e.jsx("p",{children:"No AMMs found"})}):e.jsx("div",{className:"card-container",children:a.map(n=>e.jsx("div",{onClick:()=>r(n),children:e.jsxs("div",{className:"section",children:[e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM Pubkey:"}),e.jsx("span",{className:"code-text",children:n.pubkey})]}),e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM ID:"}),e.jsxs("span",{className:"code-text",children:[n.ammid," bps"]})]}),e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM Admin:"}),e.jsxs("span",{className:"code-text",children:[n.admin," bps"]})]})]})},n.pubkey))}),e.jsx(Ge,{})]})};async function Re(a,r){try{const o=new w(r,a,{preflightCommitment:"confirmed"});return(await new P(S,o).account.pool.all()).filter(t=>t.account.poolType==0).map(t=>({poolPk:new h(t.publicKey.toString()),amm:new h(t.account.amm.toString()),mintA:new h(t.account.mintA.toString()),tokenAAmount:t.account.tokenAAmount.toString(),displayName:`${t.account.mintA.toString().slice(0,4)}}`}))}catch(o){throw console.error("Error fetching pool accounts:",o),o}}const A="/SPONGE/assets/favicon-VXsBTfPu.png",$e=({showCreatePool:a=!1,onCreatePool:r})=>{const o=y(),{connection:s}=v(),n=C(),t=K(),[c,i]=g.useState([]),[d,m]=g.useState(!0),f=async()=>{try{if(m(!0),!o)return;const l=await Re(o,s);i(l)}catch(l){console.error("Error fetching pools:",l)}finally{m(!1)}};g.useEffect(()=>{f()},[s,o]);const p=(l,u)=>{u.stopPropagation();const k=t.pathname.split("/")[1];n(`/${k}/${l.poolPk.toString()}`)};return e.jsx("div",{className:"tap-page",children:d?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"section",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"right-location-button",children:e.jsx("button",{className:"button btn-primary",onClick:r,children:"Create Pool"})}),e.jsx("div",{className:"section"})]}),c.length===0?e.jsx("span",{className:"code-text",children:"No pools available"}):c.map(l=>e.jsx("div",{className:"step",children:e.jsxs("div",{className:"row-align-center",children:[e.jsxs("div",{className:"token-pair-container",children:[e.jsx("img",{src:l.tokenAIcon||A,alt:l.tokenASymbol||"Token A",className:"token-icon",onError:u=>{u.target.src=A}}),e.jsx("div",{className:"swap-direction-toggle"}),e.jsx("img",{src:l.tokenBIcon||A,alt:l.tokenBSymbol||"Token B",className:"token-icon",onError:u=>{u.target.src=A}})]}),e.jsx("span",{className:"body-text",children:"Trading Pair: "}),e.jsx("span",{className:"code-text address-pair",children:e.jsxs("span",{children:[l.mintA.toString().slice(0,4),"...",l.mintA.toString().slice(-4)]})}),e.jsx("span",{className:"body-text",children:"Pool Address: "}),e.jsxs("span",{className:"code-text",children:[l.poolPk.toString().slice(0,4),"...",l.poolPk.toString().slice(-4)]}),e.jsx("button",{className:"button btn-primary",onClick:u=>p(l,u),children:"Details"})]})},l.poolPk.toString()))]})})},Ue=()=>{const a=C();return e.jsx("div",{children:e.jsx($e,{showCreatePool:!0,onCreatePool:()=>a("/cash/create")})})};async function Ve(a,r,o,s){try{const n=new w(r,a,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new P(S,n),c=await t.account.pool.fetch(o);let i;try{i=await t.account.amm.fetch(c.amm),console.log("amm",i)}catch(oe){console.log("amm",oe)}const d=new h(c.mintA),[m]=h.findProgramAddressSync([o.toBuffer(),n.wallet.publicKey.toBuffer(),x.Buffer.from(j)],t.programId),[f]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(j)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(F)],t.programId),[l]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(T)],t.programId),[u,k,b,_,$]=await Promise.all([He(r,o).catch(()=>!1),M(r,f,c.mintA).catch(()=>0),M(r,s,d).catch(()=>0),M(r,m,p).catch(()=>0),M(r,s,l).catch(()=>0)]);return console.log("poolAccountAInfo",k),console.log("userTokenAAccount",b),console.log("userLendingReceiptAmount",_),console.log("cashTokenMint",l.toString()),console.log("userCashAmount",$),{poolStatus:{createPool1:u},poolInfo:{poolPk:o,amm:c.amm,admin:i.admin,mintA:d,tokenASymbol:d.toString().slice(0,4),tokenAIcon:A,tokenAAmount:Number(k)},userAssets:{tokenAAmount:b.toString(),lendingReceiptAmount:_.toString(),cashAmount:$.toString()}}}catch(n){return console.error("Error getting lending pool details:",n),{poolStatus:{createPool1:!1},poolInfo:{poolPk:new h(o),amm:new h(""),admin:new h(""),mintA:new h(""),tokenAAmount:0},userAssets:{tokenAAmount:"0",lendingReceiptAmount:"0",cashAmount:"0"}}}}async function M(a,r,o){try{const s=await G(o,r,!0),n=await H(a,s);return Number(n.amount)}catch(s){return console.log("getUserTokenAmount",s),0}}async function He(a,r){return await a.getAccountInfo(r)!==null}async function Je(a,r,o,s){try{console.log("Executing lend...");const n=new w(r,a,{preflightCommitment:"confirmed"}),t=new P(S,n),c=await t.account.pool.fetch(o),i=c.mintA;console.log("mintA",i.toString()),console.log("pool.amm",c.amm.toString());const[d]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),x.Buffer.from(j)],t.programId),m=J(i,d,!0),[f]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),x.Buffer.from(F)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),x.Buffer.from(T)],t.programId),l=await N.token.associatedAddress({mint:i,owner:n.wallet.publicKey}),[u]=h.findProgramAddressSync([o.toBuffer(),n.wallet.publicKey.toBuffer(),x.Buffer.from(j)],t.programId),k=await N.token.associatedAddress({mint:f,owner:u}),b=await N.token.associatedAddress({mint:p,owner:n.wallet.publicKey});return{tx:await t.methods.lend(new Z(s)).accounts({pool:o,poolAuthority:d,poolAccountA:m,lendingReceiptTokenMint:f,cashTokenMint:p,lender:n.wallet.publicKey,lenderTokenA:l,lenderAuthority:u,lenderLendReceiptToken:k,lenderCashToken:b,payer:n.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId}).rpc(),accounts:{poolAuthority:d,lendingReceiptTokenMint:f,cashTokenMint:p,lenderTokenA:l,lenderLendReceiptToken:k,lenderCashToken:b}}}catch(n){throw console.error("Error in lend:",n),n instanceof Error&&console.error("Error details:",{message:n.message,stack:n.stack}),n}}const Ze=({pool:a,onSuccess:r})=>{const o=y(),{connection:s}=v(),[n,t]=g.useState(!1),[c,i]=g.useState(""),[d,m]=g.useState({amountA:""}),f=async p=>{p.preventDefault(),i(""),t(!0);try{const l=parseFloat(d.amountA),u=await Je(o,s,new h((a==null?void 0:a.poolPk)||""),l);r(u.tx),m({amountA:""})}catch(l){console.error("Error depositing liquidity:",l),i(l instanceof Error?l.message:"Failed to deposit liquidity")}finally{t(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsx("div",{className:"wrapper-header",children:c&&e.jsx("div",{className:"error-message",children:c})}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"input-header",children:"Token A"}),e.jsxs("div",{className:"token-input-section",children:[e.jsxs("div",{className:"token-selector",children:[e.jsx("img",{src:(a==null?void 0:a.tokenAIcon)||A,alt:(a==null?void 0:a.tokenASymbol)||"Token A",className:"token-icon",onError:p=>{p.target.src=A}}),e.jsx("span",{children:a==null?void 0:a.tokenASymbol})]}),e.jsx("input",{type:"number",step:"any",value:d.amountA,onChange:p=>m({...d,amountA:p.target.value}),placeholder:"0.00",required:!0,disabled:n})]})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:n||!o||!d.amountA,children:o?n?"Depositing Liquidity...":"Deposit Liquidity":"Connect Wallet"})]})})})};async function Xe(a,r,o){try{console.log("Executing redeem...");const s=new w(r,a,{preflightCommitment:"confirmed"}),n=new P(S,s),t=await n.account.pool.fetch(o),c=t.mintA,[i]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),x.Buffer.from(j)],n.programId),d=J(c,i,!0),[m]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),x.Buffer.from(F)],n.programId),[f]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),x.Buffer.from(T)],n.programId),p=await N.token.associatedAddress({mint:c,owner:s.wallet.publicKey}),[l]=h.findProgramAddressSync([o.toBuffer(),s.wallet.publicKey.toBuffer(),x.Buffer.from(j)],n.programId),u=await N.token.associatedAddress({mint:m,owner:l}),k=await N.token.associatedAddress({mint:f,owner:s.wallet.publicKey});return{tx:await n.methods.redeem().accounts({pool:o,poolAuthority:i,mintA:c,poolAccountA:d,lendingReceiptTokenMint:m,lender:s.wallet.publicKey,lenderTokenA:p,lenderAuthority:l,lenderLendReceiptToken:u,cashTokenMint:f,lenderCashToken:k,payer:s.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId}).rpc(),accounts:{poolAuthority:i,lendingReceiptTokenMint:m,cashTokenMint:f,lenderTokenA:p,lenderLendReceiptToken:u,lenderCashToken:k}}}catch(s){throw console.error("Error in redeem:",s),s instanceof Error&&console.error("Error details:",{message:s.message,stack:s.stack}),s}}const Qe=({pool:a,receiptAmount:r,cashAmount:o,onSuccess:s})=>{const n=y(),{connection:t}=v(),[c,i]=g.useState(!1),[d,m]=g.useState(""),f=async p=>{p.preventDefault(),m(""),i(!0);try{const l=await Xe(n,t,new h(a.poolPk));s(l.tx)}catch(l){console.error("Error depositing liquidity:",l),m(l instanceof Error?l.message:"Failed to deposit liquidity")}finally{i(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsxs("div",{className:"wrapper-header",children:[e.jsxs("div",{className:"body-text",children:["Deposited $Sol amount: ",r]}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsxs("div",{className:"body-text",children:["Owned $Cash amount: ",o]}),d&&e.jsx("div",{className:"error-message",children:d})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!n||!r,children:n?c?"Withdrawing Liquidity...":"Withdraw Liquidity":"Connect Wallet"})]})})})};async function te(a,r,o,s){try{const n=new w(r,a,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new P(S,n),[c]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer()],t.programId),[i]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(j)],t.programId),d=await N.token.associatedAddress({mint:s,owner:i}),[m]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(F)],t.programId),[f]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(T)],t.programId),[p]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(D)],t.programId),l=X.setComputeUnitLimit({units:1e6});console.log("Step 1: Creating pool...");let u="";return await ze(r,c)?console.log("Pool already exists, skipping..."):(u=await t.methods.createPool1().accounts({amm:o,mintA:s,pool:c,poolAuthority:i,poolAccountA:d,lendingReceiptTokenMint:m,cashTokenMint:f,sCashTokenMint:p,admin:q,payer:n.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId,rent:Q}).preInstructions([l]).rpc({commitment:"confirmed"}),await r.confirmTransaction(u,"confirmed"),console.log("Transaction signature:",u)),{tx1:u}}catch(n){console.error("Error",n)}return{tx1:""}}async function ze(a,r){return await a.getAccountInfo(r)!==null}const Ye=({pool:a,onTxSuccess:r,poolStatus:o})=>{const s=y(),{connection:n}=v(),[t,c]=g.useState(!1);if(o===null)return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:e.jsx("div",{className:"wrapper-box",children:e.jsx("div",{className:"align-center",children:"Loading pool status..."})})})});const i=o&&o.createPool1,d=async()=>{try{if(!s){console.error("Wallet not connected");return}if(!a){console.error("Pool not found");return}c(!0);const m=await te(s,n,a==null?void 0:a.amm,a==null?void 0:a.mintA);r(m.toString())}catch(m){console.error("Error creating pool:",m)}finally{c(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:!i&&e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"segmented-progress-bar",children:e.jsx("div",{className:`segment ${o!=null&&o.createPool1?"completed":"pending"}`,title:"Create Pool 1"})})}),e.jsx("div",{className:"step",children:e.jsx("p",{children:"This pool has not initialized completely yet. Click the button below to initialize it."})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{className:"button btn-primary",onClick:d,disabled:t,children:t?"Initializing Pool...":"Initialize Pool"})})]})})})},ne=a=>a?!a.createPool1:!0,et=()=>{const{connection:a}=v(),r=y(),{poolAddress:o}=z(),s=C(),{publicKey:n}=O(),[t,c]=g.useState(null),[i,d]=g.useState(!1),m=async()=>{try{if(!r)return;d(!0);const f=await Ve(r,a,new h(o||""),n||new h(""));c(f)}catch(f){console.error("Error fetchDetails",f)}finally{d(!1)}};return g.useEffect(()=>{m()},[o,a,n]),e.jsxs("div",{className:"card-container",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>s("/cash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),ne((t==null?void 0:t.poolStatus)||null)?e.jsx("div",{className:"section",children:e.jsx(Ye,{pool:(t==null?void 0:t.poolInfo)||null,poolStatus:(t==null?void 0:t.poolStatus)||null,onTxSuccess:m})}):e.jsxs("div",{className:"section",children:[i?e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",children:"Loading prices..."})}):t?e.jsx(e.Fragment,{children:e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"step",children:e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"body-text",children:"Pool TokenA Amount:"}),e.jsx("span",{className:"code-text",children:t==null?void 0:t.poolInfo.tokenAAmount.toFixed(6)})]})})})}):e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:"Failed to load prices"})}),e.jsx(Ze,{pool:(t==null?void 0:t.poolInfo)||null,onSuccess:m}),e.jsx("div",{className:"wrapper"}),i?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"code-text",children:"Loading your cash amount..."})}):t?e.jsx(Qe,{pool:(t==null?void 0:t.poolInfo)||null,receiptAmount:parseFloat(t.userAssets.lendingReceiptAmount),cashAmount:parseFloat(t.userAssets.cashAmount),onSuccess:m}):e.jsx("div",{className:"error-state",children:e.jsx("div",{className:"code-text",children:"Failed to load your cash amount"})}),(n==null?void 0:n.toBase58())==(t==null?void 0:t.poolInfo.admin.toString())&&e.jsx("div",{className:"step",children:e.jsx("div",{className:"info-row",children:e.jsx("div",{className:"body-text",children:"You are the admin of this pool"})})})]})]})},tt=()=>{const a=C(),r=y(),{connection:o}=v(),{amm:s}=R(),[n,t]=g.useState(""),[c,i]=g.useState(!1),[d,m]=g.useState(""),[f,p]=g.useState({mintA:""}),l=async u=>{if(u.preventDefault(),t(""),m(""),i(!0),!r){t("Please connect your wallet first"),i(!1);return}if(!s){t("Please select an AMM first"),i(!1);return}try{const k=new h(s.pubkey),b=new h(f.mintA),_=await te(r,o,k,b);m(_.toString()),p({mintA:""}),a("/cash")}catch(k){console.error("Error creating pool:",k),t(k instanceof Error?k.message:"Failed to create pool")}finally{i(!1)}};return e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>a("/cash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),e.jsx("div",{className:"wrapper-container",children:e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"section-title",children:"Create New Pool"}),e.jsx("div",{className:"note-text",children:"Note: Init pool need sign 5 times"}),n&&e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:n}),d&&e.jsxs("div",{children:[e.jsx("span",{className:"code-text",style:{color:"var(--primary)"},children:"Pool created successfully!"}),e.jsx("a",{href:`https://explorer.solana.com/tx/${d}`,target:"_blank",rel:"noopener noreferrer",className:"code-text",style:{marginLeft:"var(--spacing-xs)"},children:"View transaction"})]}),e.jsxs("form",{onSubmit:l,children:[e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"SPONGE Pubkey"}),e.jsx("input",{className:"input",type:"text",value:s?s.pubkey:"",readOnly:!0,disabled:!0})]}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"Token A Mint Address"}),e.jsx("input",{className:"input",type:"text",value:f.mintA,onChange:u=>p({...f,mintA:u.target.value}),placeholder:"Enter token A mint address",required:!0,disabled:c})]}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!r,children:c?"Creating...":"Create Pool"})})]})]})})]})};async function nt(a,r){try{const o=new w(r,a,{preflightCommitment:"confirmed"}),s=new P(S,o);console.log("catch cash pool");const n=await s.account.pool.all();return console.log("accounts",n),console.log("pool accounts",n[0].account.poolType),n.filter(t=>t.account.poolType==1).map(t=>({poolPk:new h(t.publicKey.toString()),amm:new h(t.account.amm.toString()),mintA:new h(t.account.mintA.toString()),tokenAAmount:t.account.tokenAAmount.toString(),displayName:`${t.account.mintA.toString().slice(0,4)}`}))}catch(o){throw console.error("Error fetching cash pool accounts:",o),o}}const at=({showCreatePool:a=!1,onCreatePool:r})=>{const o=y(),{connection:s}=v(),n=C(),t=K(),[c,i]=g.useState([]),[d,m]=g.useState(!0),f=async()=>{try{if(m(!0),!o)return;const l=await nt(o,s);i(l)}catch(l){console.error("Error fetching pools:",l)}finally{m(!1)}};g.useEffect(()=>{f()},[s,o]);const p=(l,u)=>{u.stopPropagation();const k=t.pathname.split("/")[1];n(`/${k}/${l.poolPk.toString()}`)};return e.jsx("div",{className:"tap-page",children:d?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"section",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"right-location-button",children:e.jsx("button",{className:"button btn-primary",onClick:r,children:"Create Pool"})}),e.jsx("div",{className:"section"})]}),c.length===0?e.jsx("span",{className:"code-text",children:"No pools available"}):c.map(l=>e.jsx("div",{className:"step",children:e.jsxs("div",{className:"row-align-center",children:[e.jsxs("div",{className:"token-pair-container",children:[e.jsx("img",{src:l.tokenAIcon||A,alt:l.tokenASymbol||"Token A",className:"token-icon",onError:u=>{u.target.src=A}}),e.jsx("div",{className:"swap-direction-toggle"}),e.jsx("img",{src:l.tokenBIcon||A,alt:l.tokenBSymbol||"Token B",className:"token-icon",onError:u=>{u.target.src=A}})]}),e.jsx("span",{className:"body-text",children:"Trading Pair: "}),e.jsx("span",{className:"code-text address-pair",children:e.jsxs("span",{children:[l.mintA.toString().slice(0,4),"...",l.mintA.toString().slice(-4)]})}),e.jsx("span",{className:"body-text",children:"Pool Address: "}),e.jsxs("span",{className:"code-text",children:[l.poolPk.toString().slice(0,4),"...",l.poolPk.toString().slice(-4)]}),e.jsx("button",{className:"button btn-primary",onClick:u=>p(l,u),children:"Details"})]})},l.poolPk.toString()))]})})},st=()=>{const a=C();return e.jsx("div",{children:e.jsx(at,{showCreatePool:!0,onCreatePool:()=>a("/scash/create")})})};async function ot(a,r,o,s){try{const n=new w(r,a,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new P(S,n),c=await t.account.pool.fetch(o);let i;try{i=await t.account.amm.fetch(c.amm),console.log("amm",i)}catch(_){console.log("amm",_)}const d=new h(c.mintA),[m]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(j)],t.programId),[f]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(D)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),d.toBuffer(),x.Buffer.from(T)],t.programId),[l,u,k,b]=await Promise.all([rt(r,o).catch(()=>!1),W(r,m,p).catch(()=>0),W(r,s,f).catch(()=>0),W(r,s,p).catch(()=>0)]);return console.log("poolAccountAInfo",l),console.log("poolCashAmount",u),console.log("userCashAmount",k),console.log("userSCashAmount",b),{poolStatus:{createPool1:l},poolInfo:{poolPk:o,amm:c.amm,admin:i.admin,mintA:d,tokenASymbol:d.toString().slice(0,4),tokenAIcon:A,tokenAAmount:Number(u)},userAssets:{poolCashAmount:u.toString(),userCashAmount:k.toString(),userSCashAmount:b.toString()}}}catch(n){return console.error("Error getting lending pool details:",n),{poolStatus:{createPool1:!1},poolInfo:{poolPk:new h(o),amm:new h(""),admin:new h(""),mintA:new h(""),tokenAAmount:0},userAssets:{poolCashAmount:"0",userCashAmount:"0",userSCashAmount:"0"}}}}async function W(a,r,o){try{const s=await G(o,r,!0),n=await H(a,s);return Number(n.amount)}catch(s){return console.log("getUserTokenAmount",s),0}}async function rt(a,r){return await a.getAccountInfo(r)!==null}async function ct(a,r,o,s){try{console.log("Executing lendCash...");const n=new w(r,a,{preflightCommitment:"confirmed"}),t=new P(S,n),c=await t.account.pool.fetch(o);console.log("pool.amm",c.amm.toString());const[i]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),x.Buffer.from(j)],t.programId),[d]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),x.Buffer.from(T)],t.programId),[m]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),x.Buffer.from(D)],t.programId),f=await N.token.associatedAddress({mint:d,owner:i}),p=await N.token.associatedAddress({mint:d,owner:n.wallet.publicKey}),l=await N.token.associatedAddress({mint:m,owner:n.wallet.publicKey});return{tx:await t.methods.lendCash(new Z(s)).accounts({mintA:c.mintA,cashPool:o,poolAuthority:i,poolAccountCash:f,cashTokenMint:d,sCashTokenMint:m,lender:n.wallet.publicKey,lenderCashToken:p,lenderSashToken:l,payer:n.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId}).rpc(),accounts:{poolAuthority:i,cashTokenMint:d,lenderCashToken:p}}}catch(n){throw console.error("Error in lendCash:",n),n instanceof Error&&console.error("Error details:",{message:n.message,stack:n.stack}),n}}const it=({pool:a,onSuccess:r})=>{const o=y(),{connection:s}=v(),[n,t]=g.useState(!1),[c,i]=g.useState(""),[d,m]=g.useState({amountA:""}),f=async p=>{p.preventDefault(),i(""),t(!0);try{const l=parseFloat(d.amountA),u=await ct(o,s,new h((a==null?void 0:a.poolPk)||""),l);r(u.tx),m({amountA:""})}catch(l){console.error("Error depositing liquidity:",l),i(l instanceof Error?l.message:"Failed to deposit liquidity")}finally{t(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsx("div",{className:"wrapper-header",children:c&&e.jsx("div",{className:"error-message",children:c})}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"input-header",children:"Token A"}),e.jsxs("div",{className:"token-input-section",children:[e.jsxs("div",{className:"token-selector",children:[e.jsx("img",{src:(a==null?void 0:a.tokenAIcon)||A,alt:(a==null?void 0:a.tokenASymbol)||"Token A",className:"token-icon",onError:p=>{p.target.src=A}}),e.jsx("span",{children:a==null?void 0:a.tokenASymbol})]}),e.jsx("input",{type:"number",step:"any",value:d.amountA,onChange:p=>m({...d,amountA:p.target.value}),placeholder:"0.00",required:!0,disabled:n})]})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:n||!o||!d.amountA,children:o?n?"Depositing Liquidity...":"Deposit Liquidity":"Connect Wallet"})]})})})};async function lt(a,r,o){try{console.log("Executing redeemCash...");const s=new w(r,a,{preflightCommitment:"confirmed"}),n=new P(S,s),t=await n.account.pool.fetch(o),[c]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),x.Buffer.from(j)],n.programId),[i]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),x.Buffer.from(T)],n.programId),d=await N.token.associatedAddress({mint:i,owner:c}),[m]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),x.Buffer.from(D)],n.programId),[f]=h.findProgramAddressSync([o.toBuffer(),s.wallet.publicKey.toBuffer(),x.Buffer.from(j)],n.programId),p=await N.token.associatedAddress({mint:i,owner:s.wallet.publicKey}),l=await N.token.associatedAddress({mint:m,owner:s.wallet.publicKey});return{tx:await n.methods.redeemCash().accounts({cashPool:o,poolAuthority:c,poolAccountCash:d,cashTokenMint:i,sCashTokenMint:m,lender:s.wallet.publicKey,lenderAuthority:f,lenderCashToken:p,lenderSCashToken:l,payer:s.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId}).rpc(),accounts:{poolAuthority:c,cashTokenMint:i,lenderCashToken:p}}}catch(s){throw console.error("Error in redeem:",s),s instanceof Error&&console.error("Error details:",{message:s.message,stack:s.stack}),s}}const dt=({pool:a,poolCashAmount:r,userCashAmount:o,userSCashAmount:s,onSuccess:n})=>{const t=y(),{connection:c}=v(),[i,d]=g.useState(!1),[m,f]=g.useState(""),p=async l=>{l.preventDefault(),f(""),d(!0);try{const u=await lt(t,c,new h(a.poolPk));n(u.tx)}catch(u){console.error("Error depositing liquidity:",u),f(u instanceof Error?u.message:"Failed to deposit liquidity")}finally{d(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:p,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsxs("div",{className:"wrapper-header",children:[e.jsxs("div",{className:"body-text",children:["Deposited  $Cash amount: ",r]}),m&&e.jsx("div",{className:"error-message",children:m}),e.jsxs("div",{className:"body-text",children:["Owned  $Cash amount: ",o]}),m&&e.jsx("div",{className:"error-message",children:m}),e.jsxs("div",{className:"body-text",children:["Owned $SCASH amount: ",s]}),m&&e.jsx("div",{className:"error-message",children:m})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:i||!t||!r,children:t?i?"Withdrawing Liquidity...":"Withdraw Liquidity":"Connect Wallet"})]})})})};async function ae(a,r,o,s){try{const n=new w(r,a,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new P(S,n),[c]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(Be)],t.programId),[i]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(j)],t.programId),[d]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(T)],t.programId),[m]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),x.Buffer.from(D)],t.programId),f=X.setComputeUnitLimit({units:1e6});console.log("Step 1: Creating cash pool...");let p="";return await mt(r,c)?console.log("Pool already exists, skipping..."):(p=await t.methods.createCashPool().accounts({amm:o,mintA:s,cashTokenMint:d,cashPool:c,poolAuthority:i,sCashTokenMint:m,admin:q,payer:n.wallet.publicKey,tokenProgram:B,associatedTokenProgram:I,systemProgram:E.programId,rent:Q}).preInstructions([f]).rpc({commitment:"confirmed"}),await r.confirmTransaction(p,"confirmed"),console.log("Transaction signature:",p)),{tx1:p}}catch(n){console.error("Error",n)}return{tx1:""}}async function mt(a,r){return await a.getAccountInfo(r)!==null}const ut=({pool:a,onTxSuccess:r,poolStatus:o})=>{const s=y(),{connection:n}=v(),[t,c]=g.useState(!1);if(o===null)return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:e.jsx("div",{className:"wrapper-box",children:e.jsx("div",{className:"align-center",children:"Loading pool status..."})})})});const i=o&&o.createPool1,d=async()=>{try{if(!s){console.error("Wallet not connected");return}if(!a){console.error("Pool not found");return}c(!0);const m=await ae(s,n,a==null?void 0:a.amm,a==null?void 0:a.mintA);r(m.toString())}catch(m){console.error("Error creating pool:",m)}finally{c(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:!i&&e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"segmented-progress-bar",children:e.jsx("div",{className:`segment ${o!=null&&o.createPool1?"completed":"pending"}`,title:"Create Pool 1"})})}),e.jsx("div",{className:"step",children:e.jsx("p",{children:"This pool has not initialized completely yet. Click the button below to initialize it."})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{className:"button btn-primary",onClick:d,disabled:t,children:t?"Initializing Pool...":"Initialize Pool"})})]})})})},pt=()=>{const{connection:a}=v(),r=y(),{poolAddress:o}=z(),s=C(),{publicKey:n}=O(),[t,c]=g.useState(null),[i,d]=g.useState(!1),m=async()=>{try{if(!r)return;d(!0);const f=await ot(r,a,new h(o||""),n||new h(""));c(f)}catch(f){console.error("Error fetchDetails",f)}finally{d(!1)}};return g.useEffect(()=>{m()},[o,a,n]),e.jsxs("div",{className:"card-container",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>s("/scash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),ne((t==null?void 0:t.poolStatus)||null)?e.jsx("div",{className:"section",children:e.jsx(ut,{pool:(t==null?void 0:t.poolInfo)||null,poolStatus:(t==null?void 0:t.poolStatus)||null,onTxSuccess:m})}):e.jsxs("div",{className:"section",children:[i?e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",children:"Loading prices..."})}):t?e.jsx(e.Fragment,{children:e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"step",children:e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"body-text",children:"Pool TokenA Amount:"}),e.jsx("span",{className:"code-text",children:t==null?void 0:t.poolInfo.tokenAAmount.toFixed(6)})]})})})}):e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:"Failed to load prices"})}),e.jsx(it,{pool:(t==null?void 0:t.poolInfo)||null,onSuccess:m}),e.jsx("div",{className:"wrapper"}),i?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"code-text",children:"Loading your cash amount..."})}):t?e.jsx(dt,{pool:(t==null?void 0:t.poolInfo)||null,poolCashAmount:parseFloat(t.userAssets.poolCashAmount),userCashAmount:parseFloat(t.userAssets.userCashAmount),userSCashAmount:parseFloat(t.userAssets.userSCashAmount),onSuccess:m}):e.jsx("div",{className:"error-state",children:e.jsx("div",{className:"code-text",children:"Failed to load your cash amount"})}),(n==null?void 0:n.toBase58())==(t==null?void 0:t.poolInfo.admin.toString())&&e.jsx("div",{className:"step",children:e.jsx("div",{className:"info-row",children:e.jsx("div",{className:"body-text",children:"You are the admin of this pool"})})})]})]})},ht=()=>{const a=C(),r=y(),{connection:o}=v(),{amm:s}=R(),[n,t]=g.useState(""),[c,i]=g.useState(!1),[d,m]=g.useState(""),[f,p]=g.useState({mintA:""}),l=async u=>{if(u.preventDefault(),t(""),m(""),i(!0),!r){t("Please connect your wallet first"),i(!1);return}if(!s){t("Please select an AMM first"),i(!1);return}try{const k=new h(s.pubkey),b=new h(f.mintA),_=await ae(r,o,k,b);m(_.toString()),p({mintA:""}),a("/scash")}catch(k){console.error("Error creating pool:",k),t(k instanceof Error?k.message:"Failed to create pool")}finally{i(!1)}};return e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>a("/scash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),e.jsx("div",{className:"wrapper-container",children:e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"section-title",children:"Create New Pool"}),e.jsx("div",{className:"note-text",children:"Note: Init pool need sign 5 times"}),n&&e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:n}),d&&e.jsxs("div",{children:[e.jsx("span",{className:"code-text",style:{color:"var(--primary)"},children:"Pool created successfully!"}),e.jsx("a",{href:`https://explorer.solana.com/tx/${d}`,target:"_blank",rel:"noopener noreferrer",className:"code-text",style:{marginLeft:"var(--spacing-xs)"},children:"View transaction"})]}),e.jsxs("form",{onSubmit:l,children:[e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"SPONGE Pubkey"}),e.jsx("input",{className:"input",type:"text",value:s?s.pubkey:"",readOnly:!0,disabled:!0})]}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"Token A Mint Address"}),e.jsx("input",{className:"input",type:"text",value:f.mintA,onChange:u=>p({...f,mintA:u.target.value}),placeholder:"Enter token A mint address",required:!0,disabled:c})]}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!r,children:c?"Creating...":"Create Pool"})})]})]})})]})},ft=()=>e.jsxs("div",{className:"card-container",children:[e.jsx("h1",{className:"title",children:"Welcome to SPONGE Protocol"}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"What is SPONGE Protocol?"}),e.jsx("p",{children:"SPONGE is a decentralized stablecoin protocol for payfi on solana ."})]}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Key Features"}),e.jsxs("div",{className:"feature",children:[e.jsx("h3",{children:"⚡ ---"}),e.jsx("p",{children:"..."})]})]})]}),gt=[{path:"/",component:Le,children:[{path:"",component:U},{path:"introduction",component:ft,meta:{title:"Introduction"}},{path:"guide",component:U,meta:{title:"Guide"}},{path:"amm",component:qe,meta:{title:"AMM"}},{path:"cash",component:Ue,meta:{title:"Cash"}},{path:"cash/create",component:tt,meta:{title:"Create Cash Pool"}},{path:"cash/:poolAddress",component:et,meta:{title:"Cash Pool Item"}},{path:"scash",component:st,meta:{title:"Scash"}},{path:"scash/create",component:ht,meta:{title:"Create Scash Pool"}},{path:"scash/:poolAddress",component:pt,meta:{title:"Scash Pool Item"}}]}];function se(a){return a.map(r=>({path:r.path,element:e.jsx(r.component,{}),children:r.children?se(r.children):void 0}))}const xt=se(gt),V="/SPONGE/assets/favicon-VXsBTfPu.png",kt=()=>{const{connected:a}=O(),{network:r,setNetwork:o}=Ae(),s=ge(xt);return e.jsxs("div",{className:"app-container",children:[e.jsxs("nav",{className:"app-nav",children:[e.jsxs("div",{className:"brand",children:[e.jsx("img",{src:V,alt:"SPONGE Logo",className:"app-logo"}),e.jsx("h1",{className:"cash-title",children:"SPONGE"})]}),e.jsxs("div",{className:"controls",children:[e.jsx(Ne,{onChange:o,value:r}),e.jsx(xe,{className:"button btn-primary"})]})]}),e.jsx("main",{className:"app-main",children:a?s:e.jsx("div",{className:"connect-wallet",children:e.jsxs("div",{className:"wrapper",children:[e.jsx("img",{src:V,alt:"SPONGE Logo",className:"connect-logo"}),e.jsx("h2",{className:"section-title",children:"Welcome to SPONGE"}),e.jsx("p",{className:"section-title",children:"Connect your wallet to continue"})]})})}),e.jsxs("div",{className:"social-links-corner",children:[e.jsx("a",{href:"https://github.com/yimingWOW/cash",target:"_blank",rel:"noopener noreferrer",className:"text-link",children:e.jsx("i",{className:"fab fa-github"})}),e.jsx("a",{href:"https://x.com/fall_labs",target:"_blank",rel:"noopener noreferrer",className:"text-link",children:e.jsx("i",{className:"fa-brands fa-x-twitter"})})]})]})},yt=()=>e.jsx(We,{children:e.jsx(kt,{})});ke.createRoot(document.getElementById("root")).render(e.jsx(ye.StrictMode,{children:e.jsx(ve,{children:e.jsx(je,{children:e.jsx(yt,{})})})}));
