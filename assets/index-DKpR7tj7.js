import{r as g,P as ie,j as e,C as le,W as de,a as me,c as ue,u as O,b as C,d as K,O as pe,g as G,N as he,T as fe,S as T,L as ge,e as xe,f as y,h as v,A as j,i as N,k as h,l as k,m as J,n as X,o as A,B as Z,p as B,q as L,s as Q,t as z,v as Y,w as ke,x as ye,y as ve,R as be,H as Ae}from"./vendor-Cj4Bv78W.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerPolicy&&(t.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?t.credentials="include":a.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(a){if(a.ep)return;a.ep=!0;const t=o(a);fetch(a.href,t)}})();const ee=g.createContext({network:"localnet",setNetwork:()=>{}}),je=()=>g.useContext(ee),Ne={"mainnet-beta":ue("mainnet-beta"),devnet:"https://greatest-tiniest-mansion.solana-devnet.quiknode.pro/a65e3540c3a32f0f22ed654ea1df784f0a471f51/",localnet:"http://127.0.0.1:8899"},we=({onChange:n,value:r})=>e.jsx("div",{className:"solana-network-select-container",children:e.jsxs("select",{onChange:o=>n(o.target.value),value:r,className:"solana-network-select",children:[e.jsx("option",{value:"devnet",children:"Devnet"}),e.jsx("option",{value:"localnet",children:"Localnet"}),e.jsx("option",{value:"mainnet-beta",children:"Mainnet"})]})}),Se=({children:n})=>{const[r,o]=g.useState("devnet"),s=g.useMemo(()=>Ne[r],[r]),a=g.useMemo(()=>[new ie],[]);return e.jsx(ee.Provider,{value:{network:r,setNetwork:o},children:e.jsx(le,{endpoint:s,children:e.jsx(de,{wallets:a,autoConnect:!0,children:e.jsx(me,{children:n})})})})},Pe="EYCdeLWKH7F5JejES1aPvGBqFaT9S1e2roEThq1y9FAR",_e={name:"cash",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},Ce=[{name:"create_amm",discriminator:[242,91,21,170,5,68,125,64],accounts:[{name:"amm",writable:!0,pda:{seeds:[{kind:"arg",path:"id"}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"id",type:"pubkey"}]},{name:"create_cash_pool",discriminator:[251,107,117,98,219,201,139,87],accounts:[{name:"amm",pda:{seeds:[{kind:"account",path:"amm.id",account:"Amm"}]}},{name:"mint_a"},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"cash_pool",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[97]}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"create_pool_1",discriminator:[65,185,40,205,113,45,173,179],accounts:[{name:"amm",pda:{seeds:[{kind:"account",path:"amm.id",account:"Amm"}]}},{name:"mint_a"},{name:"pool",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[97]}]}},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"mint_a"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[101]}]}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"amm"},{kind:"account",path:"mint_a"},{kind:"const",value:[103]}]}},{name:"admin"},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"lend",discriminator:[89,34,75,168,122,47,185,45],accounts:[{name:"pool",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[101]}]}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"lender",signer:!0},{name:"lender_token_a",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_authority",pda:{seeds:[{kind:"account",path:"pool"},{kind:"account",path:"lender"},{kind:"const",value:[97]}]}},{name:"lender_lend_receipt_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"lending_receipt_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",docs:["The account paying for all rents"],writable:!0,signer:!0},{name:"token_program",docs:["Solana ecosystem accounts"],address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"user_lending_amount",type:"u64"}]},{name:"lend_cash",discriminator:[11,66,11,107,38,72,149,243],accounts:[{name:"mint_a"},{name:"cash_pool",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_cash",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"mint_a"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"mint_a"},{kind:"const",value:[103]}]}},{name:"lender",signer:!0},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_scash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"s_cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",docs:["The account paying for all rents"],writable:!0,signer:!0},{name:"token_program",docs:["Solana ecosystem accounts"],address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"user_lending_amount",type:"u64"}]},{name:"redeem",discriminator:[184,12,86,149,70,196,97,225],accounts:[{name:"pool",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"mint_a"},{name:"pool_account_a",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"pool.mint_a",account:"Pool"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lending_receipt_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[101]}]}},{name:"lender",signer:!0},{name:"lender_token_a",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"mint_a"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_authority",pda:{seeds:[{kind:"account",path:"pool"},{kind:"account",path:"lender"},{kind:"const",value:[97]}]}},{name:"lender_lend_receipt_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"lending_receipt_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"pool.amm",account:"Pool"},{kind:"account",path:"pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"redeem_cash",discriminator:[58,207,171,57,139,103,200,20],accounts:[{name:"cash_pool",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[98]}]}},{name:"pool_authority",pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[97]}]}},{name:"pool_account_cash",writable:!0,pda:{seeds:[{kind:"account",path:"pool_authority"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[102]}]}},{name:"s_cash_token_mint",writable:!0,pda:{seeds:[{kind:"account",path:"cash_pool.amm",account:"Pool"},{kind:"account",path:"cash_pool.mint_a",account:"Pool"},{kind:"const",value:[103]}]}},{name:"lender",signer:!0},{name:"lender_cash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"lender_scash_token",writable:!0,pda:{seeds:[{kind:"account",path:"lender"},{kind:"const",value:[6,221,246,225,215,101,161,147,217,203,225,70,206,235,121,172,28,180,133,237,95,91,55,145,58,140,245,133,126,255,0,169]},{kind:"account",path:"s_cash_token_mint"}],program:{kind:"const",value:[140,151,37,143,78,36,137,241,187,61,16,41,20,142,13,131,11,90,19,153,218,255,16,132,4,142,123,216,219,233,248,89]}}},{name:"payer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"associated_token_program",address:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]}],Te=[{name:"Amm",discriminator:[143,245,200,17,74,214,196,135]},{name:"Pool",discriminator:[241,154,109,4,17,177,109,188]}],Ee=[{code:6e3,name:"CalculationError",msg:"Calculation error"}],Be=[{name:"Amm",type:{kind:"struct",fields:[{name:"id",docs:["Primary key of the AMM"],type:"pubkey"},{name:"admin",docs:["Account that has admin authority over the AMM"],type:"pubkey"},{name:"liquidity_fee",docs:["liquidity fee percentage: 100000 = 100%"],type:"u16"},{name:"protocol_fee_percentage",docs:["Protocol fee percentage of the liquidity fee (0-100)","e.g., 10000 means 100% of liquidity fee goes to protocol"],type:"u16"}]}},{name:"Pool",type:{kind:"struct",fields:[{name:"amm",docs:["Primary key of the AMM"],type:"pubkey"},{name:"mint_a",docs:["Mint of token A"],type:"pubkey"},{name:"token_a_amount",docs:["借贷池中token a的数量"],type:"u64"},{name:"token_b_amount",docs:["借贷池中token b的数量"],type:"u64"},{name:"pool_type",type:"u64"}]}}],Le=[{name:"AUTHORITY_SEED",type:"bytes",value:"[97]"},{name:"CASH_POOL",type:"bytes",value:"[98]"},{name:"CASH_TOKEN_SEED",type:"bytes",value:"[102]"},{name:"LENDING_TOKEN_SEED",type:"bytes",value:"[101]"},{name:"SCASH_TOKEN_SEED",type:"bytes",value:"[103]"}],w={address:Pe,metadata:_e,instructions:Ce,accounts:Te,errors:Ee,types:Be,constants:Le},S="a",Ie="b",F="e",E="f",D="g",De="GUXNPX5ci1Qj76MZe2aRJ33zK48VmT6gXVyR86CsF4T5",q="EisXsrG1aCoaJTFSDdXTBRAEAZP46wPWkKJpF7RfC3DV",I=({isActive:n,onClick:r,icon:o,label:s})=>e.jsx("button",{className:`tab-button ${n?"active":""}`,onClick:r,children:e.jsxs("div",{className:"section-title",children:[o,s]})}),Me=()=>{const{publicKey:n}=O(),r=C(),s=K().pathname.split("/")[1]||"guide",a=t=>{r(`/${t}`)};return e.jsxs("div",{className:"dashboard",children:[e.jsxs("nav",{className:"tab-nav",children:[(n==null?void 0:n.toBase58())===De&&e.jsx(I,{isActive:s==="amm",onClick:()=>a("amm"),icon:"⚙️",label:"AMM"}),e.jsx(I,{isActive:s==="introduction",onClick:()=>a("introduction"),icon:"📖",label:"Introduction"}),e.jsx(I,{isActive:s==="guide",onClick:()=>a("guide"),icon:"📚",label:"Guide"}),e.jsx(I,{isActive:s==="cash",onClick:()=>a("cash"),icon:"💰",label:"Cash"}),e.jsx(I,{isActive:s==="scash",onClick:()=>a("scash"),icon:"💰",label:"Scash"})]}),e.jsx("div",{className:"dashboard-content",children:e.jsx(pe,{})})]})};async function Oe(n,r,o){try{const s=await G(he,r.publicKey),a=new fe;a.add(T.transfer({fromPubkey:r.publicKey,toPubkey:s,lamports:o*ge})),a.add(xe(s));const t=await n.getLatestBlockhash();a.recentBlockhash=t.blockhash,a.feePayer=r.publicKey;const c=await r.signTransaction(a),i=await n.sendRawTransaction(c.serialize());return await n.confirmTransaction({signature:i,...t}),i}catch(s){throw console.error("Error wrapping SOL:",s),s}}const Fe=({onSuccess:n})=>{const r=y(),{connection:o}=v(),[s,a]=g.useState(""),[t,c]=g.useState(!1),[i,l]=g.useState(""),d=async f=>{if(f.preventDefault(),a(""),c(!0),!r){a("Please connect your wallet first"),c(!1);return}if(!i||isNaN(Number(i))||Number(i)<=0){a("Please enter a valid amount"),c(!1);return}try{const p=await Oe(o,r,Number(i));console.log(`Transaction URL: https://explorer.solana.com/tx/${p}`),n(p),l("")}catch(p){console.error("Error wrapping SOL:",p),a(p instanceof Error?p.message:"Failed to wrap SOL")}finally{c(!1)}};return e.jsxs("div",{className:"wrapper",children:[s&&e.jsx("div",{className:"secondary-text",style:{color:"var(--error)"},children:s}),e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{style:{marginBottom:"var(--spacing-md)"},children:e.jsx("input",{type:"number",value:i,onChange:f=>l(f.target.value),placeholder:"Enter SOL amount",step:"any",min:"0",className:"input-field",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid var(--border-color)"}})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:t||!r||!i,children:t?"Processing...":"Wrap SOL"})})]})]})},We="/SPONGE/assets/guide_pic_1-BISUfyi8.png",U=()=>e.jsxs("div",{className:"card-container",children:[e.jsx("h1",{className:"title",children:"Getting Started with SPONGE Protocol"}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Prerequisites"}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"1. Enable Devnet in Phantom Wallet"}),e.jsx("p",{children:"Open Phantom wallet settings → Developer Settings → Open Testnet Mode"}),e.jsx("img",{src:We,alt:"Enable Devnet in Phantom",className:"guide-image"})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"2. Get Devnet Token"}),e.jsxs("p",{children:["Obtain Devnet SOL from the ",e.jsx("a",{className:"text-link",href:"https://faucet.solana.com/",target:"_blank",rel:"noopener noreferrer",children:"Solana Faucet"})]}),e.jsxs("p",{children:["Obtain Devnet USDT tokens from the ",e.jsx("a",{className:"text-link",href:"https://spl-token-faucet.com/?token-name=USDT",target:"_blank",rel:"noopener noreferrer",children:"SPL Token Faucet"})]})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"3. Convert SOL to WSOL for trading in Wsol-USDT Pool"}),e.jsx(Fe,{onSuccess:()=>{}})]})]}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Using the Protocol"}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"1. Connect Your Wallet"}),e.jsx("p",{children:'Use the "Connect Wallet" button in the top right corner'})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"2. Deposit SOL"}),e.jsx("p",{children:"You can deposit SOL into the pool and get $cash"})]}),e.jsxs("div",{className:"step",children:[e.jsx("h3",{children:"3. Withdraw SOL"}),e.jsx("p",{children:"You can withdraw SOL and repay the $cash"})]})]})]}),Ke=async(n,r)=>{console.log("Getting AMM accounts connection:",r);const o=new j(r,n,{preflightCommitment:"confirmed"}),a=await new N(w,o).account.amm.all();for(const t of a)console.log("AMM Account Details:",{publicKey:t.publicKey.toString(),id:t.account.id.toString(),admin:t.account.admin.toString()});return a.map(t=>({pubkey:t.publicKey.toString(),ammid:t.account.id.toString(),admin:t.account.admin.toString()}))},te=g.createContext(void 0),Ge=({children:n})=>{const r=y(),{connection:o}=v(),[s,a]=g.useState(null),[t,c]=g.useState([]),[i,l]=g.useState(!1),[d,f]=g.useState(null),p=u=>{console.log("Selected AMM:",u.pubkey),a(u)},m=async()=>{if(r){l(!0),f(null);try{const u=await Ke(r,o);console.log("Fetched AMM accounts:",u),c(u),u.length>0&&!s&&p(u[0])}catch(u){console.error("Error fetching AMMs:",u),f(u instanceof Error?u.message:"Failed to fetch AMMs")}finally{l(!1)}}};return g.useEffect(()=>{m()},[r,o]),e.jsx(te.Provider,{value:{amm:s,amms:t,setAmm:a,selectAmm:p,isLoading:i,error:d,refreshAmms:m},children:n})},R=()=>{const n=g.useContext(te);if(!n)throw new Error("useAmm must be used within an AmmProvider");return n};async function qe(n,r,o){try{const s=new j(r,n,{preflightCommitment:"confirmed"}),a=new N(w,s),[t]=h.findProgramAddressSync([o.toBuffer()],a.programId);return await a.methods.createAmm(o).accounts({amm:t,admin:q,payer:s.wallet.publicKey,systemProgram:T.programId}).rpc()}catch(s){throw console.error("Error details:",s),s}}const Re=()=>{const n=y(),{connection:r}=v(),[o,s]=g.useState(""),[a,t]=g.useState("500"),[c,i]=g.useState(!1),[l,d]=g.useState(""),f=async p=>{if(p.preventDefault(),s(""),i(!0),!n){s("Please connect your wallet first"),i(!1);return}const m=Number(a);if(m<1||m>1e4){s("Fee must be between 1 and 10000"),i(!1);return}try{const u=h.unique(),x=await qe(n,r,u);console.log(`Transaction URL: https://explorer.solana.com/tx/${x}`),d(u.toString()),t("500")}catch(u){console.error("Error creating AMM:",u),s(u instanceof Error?u.message:"Failed to create AMM. Please try again.")}finally{i(!1)}};return e.jsxs("div",{className:"create-amm-container",children:[o&&e.jsx("div",{className:"error-message",children:o}),l&&e.jsxs("div",{className:"success-message",children:["AMM created successfully! ID: ",l]}),e.jsx("form",{onSubmit:f,className:"form",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!n,children:c?"Creating...":"Create AMM"})})]})},$e=()=>{const{amms:n,selectAmm:r,isLoading:o,error:s}=R();return e.jsxs("div",{className:"tap-page",children:[e.jsx("h2",{children:"Existing AMMs"}),s&&e.jsx("div",{className:"error-message",children:s}),o?e.jsx("div",{children:"Loading AMMs..."}):n.length===0?e.jsx("div",{className:"card-container",children:e.jsx("p",{children:"No AMMs found"})}):e.jsx("div",{className:"card-container",children:n.map(a=>e.jsx("div",{onClick:()=>r(a),children:e.jsxs("div",{className:"section",children:[e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM Pubkey:"}),e.jsx("span",{className:"code-text",children:a.pubkey})]}),e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM ID:"}),e.jsxs("span",{className:"code-text",children:[a.ammid," bps"]})]}),e.jsxs("div",{className:"step",children:[e.jsx("span",{className:"body-text",children:"AMM Admin:"}),e.jsxs("span",{className:"code-text",children:[a.admin," bps"]})]})]})},a.pubkey))}),e.jsx(Re,{})]})};async function Ue(n,r){try{const o=new j(r,n,{preflightCommitment:"confirmed"});return(await new N(w,o).account.pool.all()).filter(t=>t.account.poolType==0).map(t=>({poolPk:new h(t.publicKey.toString()),amm:new h(t.account.amm.toString()),mintA:new h(t.account.mintA.toString()),tokenAAmount:t.account.tokenAAmount.toString(),tokenASymbol:t.account.mintA.toString()==="So11111111111111111111111111111111111111112"?"SOL":"USDT",displayName:`${t.account.mintA.toString().slice(0,4)}}`}))}catch(o){throw console.error("Error fetching pool accounts:",o),o}}const _="/SPONGE/assets/favicon-VXsBTfPu.png",Ve=(n,r=4)=>`${n.substring(0,r)}...${n.substring(n.length-r)}`,V=({address:n="",shortened:r=!0})=>{const[o,s]=g.useState(!1),a=async()=>{try{await navigator.clipboard.writeText(n),s(!0),setTimeout(()=>s(!1),2e3)}catch(t){console.error("Failed to copy text: ",t)}};return e.jsxs("div",{className:"copyable-address",children:[e.jsx("span",{className:"code-text",title:n,children:r?Ve(n):n}),e.jsx("button",{className:"secondary-button",onClick:a,title:o?"Copied!":"Copy address",children:e.jsx("div",{className:`copy-icon ${o?"copied":""}`})})]})},ne=({poolInfo:n})=>{const r=o=>{o.currentTarget.src=_};return e.jsx("div",{className:"combine-text",children:e.jsxs("div",{className:"info-row",children:[e.jsxs("div",{className:"token-pair-container",children:[e.jsx("img",{src:(n==null?void 0:n.tokenAIcon)||_,alt:(n==null?void 0:n.tokenASymbol)||"Token A",className:"token-icon",onError:r}),e.jsx("img",{src:(n==null?void 0:n.tokenBIcon)||_,alt:(n==null?void 0:n.tokenBSymbol)||"Token B",className:"token-icon",onError:r})]}),e.jsx("span",{className:"body-text",children:"Trading Pair: "}),e.jsx(V,{address:(n==null?void 0:n.tokenASymbol)||"@",shortened:!1}),e.jsx("span",{className:"body-text",children:"Pool Address:"}),e.jsx(V,{address:(n==null?void 0:n.poolPk.toString())||"#",shortened:!1})]})})},He=({showCreatePool:n=!1,onCreatePool:r})=>{const o=y(),{connection:s}=v(),a=C(),t=K(),[c,i]=g.useState([]),[l,d]=g.useState(!0),f=async()=>{try{if(d(!0),!o)return;const m=await Ue(o,s);i(m)}catch(m){console.error("Error fetching pools:",m)}finally{d(!1)}};g.useEffect(()=>{f()},[s,o]);const p=(m,u)=>{u.stopPropagation();const x=t.pathname.split("/")[1];a(`/${x}/${m.poolPk.toString()}`)};return e.jsx("div",{className:"tap-page",children:l?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"section",children:[n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"right-location-button",children:e.jsx("button",{className:"button btn-primary",onClick:r,children:"Create Pool"})}),e.jsx("div",{className:"section"})]}),c.length===0?e.jsx("span",{className:"code-text",children:"No pools available"}):c.map(m=>e.jsx("div",{className:"step",children:e.jsxs("div",{className:"row-align-center",children:[e.jsx(ne,{poolInfo:m}),e.jsx("button",{className:"button btn-primary",onClick:u=>p(m,u),children:"Details"})]})},m.poolPk.toString()))]})})},Je=()=>{const n=C();return e.jsx("div",{children:e.jsx(He,{showCreatePool:!0,onCreatePool:()=>n("/cash/create")})})};async function Xe(n,r,o,s){try{const a=new j(r,n,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new N(w,a),c=await t.account.pool.fetch(o);let i;try{i=await t.account.amm.fetch(c.amm),console.log("amm",i)}catch(ce){console.log("amm",ce)}const l=new h(c.mintA),[d]=h.findProgramAddressSync([o.toBuffer(),a.wallet.publicKey.toBuffer(),k.Buffer.from(S)],t.programId),[f]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(S)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(F)],t.programId),[m]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(E)],t.programId),[u,x,b,P,$]=await Promise.all([Ze(r,o).catch(()=>!1),M(r,f,c.mintA).catch(()=>0),M(r,s,l).catch(()=>0),M(r,d,p).catch(()=>0),M(r,s,m).catch(()=>0)]);return console.log("poolAccountAInfo",x),console.log("userTokenAAccount",b),console.log("userLendingReceiptAmount",P),console.log("cashTokenMint",m.toString()),console.log("userCashAmount",$),{poolStatus:{createPool1:u},poolInfo:{poolPk:o,amm:c.amm,admin:i.admin,mintA:l,tokenASymbol:l.toString()==="So11111111111111111111111111111111111111112"?"SOL":"USDT",tokenAIcon:_,tokenAAmount:Number(x)},userAssets:{tokenAAmount:b.toString(),lendingReceiptAmount:P.toString(),cashAmount:$.toString()}}}catch(a){return console.error("Error getting lending pool details:",a),{poolStatus:{createPool1:!1},poolInfo:{poolPk:new h(o),amm:new h(""),admin:new h(""),mintA:new h(""),tokenAAmount:0},userAssets:{tokenAAmount:"0",lendingReceiptAmount:"0",cashAmount:"0"}}}}async function M(n,r,o){try{const s=await G(o,r,!0),a=await J(n,s);return Number(a.amount)}catch(s){return console.log("getUserTokenAmount",s),0}}async function Ze(n,r){return await n.getAccountInfo(r)!==null}async function Qe(n,r,o,s){try{console.log("Executing lend...");const a=new j(r,n,{preflightCommitment:"confirmed"}),t=new N(w,a),c=await t.account.pool.fetch(o),i=c.mintA;console.log("mintA",i.toString()),console.log("pool.amm",c.amm.toString());const[l]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),k.Buffer.from(S)],t.programId),d=X(i,l,!0),[f]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),k.Buffer.from(F)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),i.toBuffer(),k.Buffer.from(E)],t.programId),m=await A.token.associatedAddress({mint:i,owner:a.wallet.publicKey}),[u]=h.findProgramAddressSync([o.toBuffer(),a.wallet.publicKey.toBuffer(),k.Buffer.from(S)],t.programId),x=await A.token.associatedAddress({mint:f,owner:u}),b=await A.token.associatedAddress({mint:p,owner:a.wallet.publicKey});return{tx:await t.methods.lend(new Z(s)).accounts({pool:o,poolAuthority:l,poolAccountA:d,lendingReceiptTokenMint:f,cashTokenMint:p,lender:a.wallet.publicKey,lenderTokenA:m,lenderAuthority:u,lenderLendReceiptToken:x,lenderCashToken:b,payer:a.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId}).rpc(),accounts:{poolAuthority:l,lendingReceiptTokenMint:f,cashTokenMint:p,lenderTokenA:m,lenderLendReceiptToken:x,lenderCashToken:b}}}catch(a){throw console.error("Error in lend:",a),a instanceof Error&&console.error("Error details:",{message:a.message,stack:a.stack}),a}}const ze=({pool:n,onSuccess:r})=>{const o=y(),{connection:s}=v(),[a,t]=g.useState(!1),[c,i]=g.useState(""),[l,d]=g.useState({amountA:""}),f=async p=>{p.preventDefault(),i(""),t(!0);try{const m=parseFloat(l.amountA),u=await Qe(o,s,new h((n==null?void 0:n.poolPk)||""),m);r(u.tx),d({amountA:""})}catch(m){console.error("Error depositing liquidity:",m),i(m instanceof Error?m.message:"Failed to deposit liquidity")}finally{t(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsx("div",{className:"wrapper-header",children:c&&e.jsx("div",{className:"error-message",children:c})}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"input-header",children:"Token A"}),e.jsxs("div",{className:"token-input-section",children:[e.jsxs("div",{className:"token-selector",children:[e.jsx("img",{src:(n==null?void 0:n.tokenAIcon)||_,alt:(n==null?void 0:n.tokenASymbol)||"Token A",className:"token-icon",onError:p=>{p.target.src=_}}),e.jsx("span",{children:n==null?void 0:n.tokenASymbol})]}),e.jsx("input",{type:"number",step:"any",value:l.amountA,onChange:p=>d({...l,amountA:p.target.value}),placeholder:"0.00",required:!0,disabled:a})]})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:a||!o||!l.amountA,children:o?a?"Depositing Liquidity...":"Deposit Liquidity":"Connect Wallet"})]})})})};async function Ye(n,r,o){try{console.log("Executing redeem...");const s=new j(r,n,{preflightCommitment:"confirmed"}),a=new N(w,s),t=await a.account.pool.fetch(o),c=t.mintA,[i]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),k.Buffer.from(S)],a.programId),l=X(c,i,!0),[d]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),k.Buffer.from(F)],a.programId),[f]=h.findProgramAddressSync([t.amm.toBuffer(),c.toBuffer(),k.Buffer.from(E)],a.programId),p=await A.token.associatedAddress({mint:c,owner:s.wallet.publicKey}),[m]=h.findProgramAddressSync([o.toBuffer(),s.wallet.publicKey.toBuffer(),k.Buffer.from(S)],a.programId),u=await A.token.associatedAddress({mint:d,owner:m}),x=await A.token.associatedAddress({mint:f,owner:s.wallet.publicKey});return{tx:await a.methods.redeem().accounts({pool:o,poolAuthority:i,mintA:c,poolAccountA:l,lendingReceiptTokenMint:d,lender:s.wallet.publicKey,lenderTokenA:p,lenderAuthority:m,lenderLendReceiptToken:u,cashTokenMint:f,lenderCashToken:x,payer:s.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId}).rpc(),accounts:{poolAuthority:i,lendingReceiptTokenMint:d,cashTokenMint:f,lenderTokenA:p,lenderLendReceiptToken:u,lenderCashToken:x}}}catch(s){throw console.error("Error in redeem:",s),s instanceof Error&&console.error("Error details:",{message:s.message,stack:s.stack}),s}}const et=({pool:n,receiptAmount:r,cashAmount:o,onSuccess:s})=>{const a=y(),{connection:t}=v(),[c,i]=g.useState(!1),[l,d]=g.useState(""),f=async p=>{p.preventDefault(),d(""),i(!0);try{const m=await Ye(a,t,new h(n.poolPk));s(m.tx)}catch(m){console.error("Error depositing liquidity:",m),d(m instanceof Error?m.message:"Failed to deposit liquidity")}finally{i(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsxs("div",{className:"wrapper-header",children:[e.jsxs("div",{className:"body-text",children:["Margin ratio: ",o/r*100,"%"]}),l&&e.jsx("div",{className:"error-message",children:l}),e.jsxs("div",{className:"body-text",children:["Deposited $Sol value: ",r]}),l&&e.jsx("div",{className:"error-message",children:l}),e.jsxs("div",{className:"body-text",children:["Owned $Cash value: ",o]}),l&&e.jsx("div",{className:"error-message",children:l})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!a||!r,children:a?c?"Withdrawing Liquidity...":"Withdraw Liquidity":"Connect Wallet"})]})})})};async function ae(n,r,o,s){try{const a=new j(r,n,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new N(w,a),[c]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer()],t.programId),[i]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(S)],t.programId),l=await A.token.associatedAddress({mint:s,owner:i}),[d]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(F)],t.programId),[f]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(E)],t.programId),[p]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(D)],t.programId),m=Q.setComputeUnitLimit({units:1e6});console.log("Step 1: Creating pool...");let u="";return await tt(r,c)?console.log("Pool already exists, skipping..."):(u=await t.methods.createPool1().accounts({amm:o,mintA:s,pool:c,poolAuthority:i,poolAccountA:l,lendingReceiptTokenMint:d,cashTokenMint:f,sCashTokenMint:p,admin:q,payer:a.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId,rent:z}).preInstructions([m]).rpc({commitment:"confirmed"}),await r.confirmTransaction(u,"confirmed"),console.log("Transaction signature:",u)),{tx1:u}}catch(a){console.error("Error",a)}return{tx1:""}}async function tt(n,r){return await n.getAccountInfo(r)!==null}const nt=({pool:n,onTxSuccess:r,poolStatus:o})=>{const s=y(),{connection:a}=v(),[t,c]=g.useState(!1);if(o===null)return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:e.jsx("div",{className:"wrapper-box",children:e.jsx("div",{className:"align-center",children:"Loading pool status..."})})})});const i=o&&o.createPool1,l=async()=>{try{if(!s){console.error("Wallet not connected");return}if(!n){console.error("Pool not found");return}c(!0);const d=await ae(s,a,n==null?void 0:n.amm,n==null?void 0:n.mintA);r(d.toString())}catch(d){console.error("Error creating pool:",d)}finally{c(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:!i&&e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"segmented-progress-bar",children:e.jsx("div",{className:`segment ${o!=null&&o.createPool1?"completed":"pending"}`,title:"Create Pool 1"})})}),e.jsx("div",{className:"step",children:e.jsx("p",{children:"This pool has not initialized completely yet. Click the button below to initialize it."})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{className:"button btn-primary",onClick:l,disabled:t,children:t?"Initializing Pool...":"Initialize Pool"})})]})})})},se=n=>n?!n.createPool1:!0,at=()=>{const{connection:n}=v(),r=y(),{poolAddress:o}=Y(),s=C(),{publicKey:a}=O(),[t,c]=g.useState(null),[i,l]=g.useState(!1),d=async()=>{try{if(!r)return;l(!0);const f=await Xe(r,n,new h(o||""),a||new h(""));c(f)}catch(f){console.error("Error fetchDetails",f)}finally{l(!1)}};return g.useEffect(()=>{d()},[o,n,a]),e.jsxs("div",{className:"card-container",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>s("/cash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),se((t==null?void 0:t.poolStatus)||null)?e.jsx("div",{className:"section",children:e.jsx(nt,{pool:(t==null?void 0:t.poolInfo)||null,poolStatus:(t==null?void 0:t.poolStatus)||null,onTxSuccess:d})}):e.jsxs("div",{className:"section",children:[i?e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",children:"Loading prices..."})}):t?e.jsx(e.Fragment,{children:e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"step",children:e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"body-text",children:"Pool TokenA Amount:"}),e.jsx("span",{className:"code-text",children:t==null?void 0:t.poolInfo.tokenAAmount.toFixed(6)})]})})})}):e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:"Failed to load prices"})}),e.jsx(ze,{pool:(t==null?void 0:t.poolInfo)||null,onSuccess:d}),e.jsx("div",{className:"wrapper"}),i?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"code-text",children:"Loading your cash amount..."})}):t?e.jsx(et,{pool:(t==null?void 0:t.poolInfo)||null,receiptAmount:parseFloat(t.userAssets.lendingReceiptAmount),cashAmount:parseFloat(t.userAssets.cashAmount),onSuccess:d}):e.jsx("div",{className:"error-state",children:e.jsx("div",{className:"code-text",children:"Failed to load your cash amount"})}),(a==null?void 0:a.toBase58())==(t==null?void 0:t.poolInfo.admin.toString())&&e.jsx("div",{className:"step",children:e.jsx("div",{className:"info-row",children:e.jsx("div",{className:"body-text",children:"You are the admin of this pool"})})})]})]})},st=()=>{const n=C(),r=y(),{connection:o}=v(),{amm:s}=R(),[a,t]=g.useState(""),[c,i]=g.useState(!1),[l,d]=g.useState(""),[f,p]=g.useState({mintA:""}),m=async u=>{if(u.preventDefault(),t(""),d(""),i(!0),!r){t("Please connect your wallet first"),i(!1);return}if(!s){t("Please select an AMM first"),i(!1);return}try{const x=new h(s.pubkey),b=new h(f.mintA),P=await ae(r,o,x,b);d(P.toString()),p({mintA:""}),n("/cash")}catch(x){console.error("Error creating pool:",x),t(x instanceof Error?x.message:"Failed to create pool")}finally{i(!1)}};return e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>n("/cash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),e.jsx("div",{className:"wrapper-container",children:e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"section-title",children:"Create New Pool"}),e.jsx("div",{className:"note-text",children:"Note: Init pool need sign 5 times"}),a&&e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:a}),l&&e.jsxs("div",{children:[e.jsx("span",{className:"code-text",style:{color:"var(--primary)"},children:"Pool created successfully!"}),e.jsx("a",{href:`https://explorer.solana.com/tx/${l}`,target:"_blank",rel:"noopener noreferrer",className:"code-text",style:{marginLeft:"var(--spacing-xs)"},children:"View transaction"})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"SPONGE Pubkey"}),e.jsx("input",{className:"input",type:"text",value:s?s.pubkey:"",readOnly:!0,disabled:!0})]}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"Token A Mint Address"}),e.jsx("input",{className:"input",type:"text",value:f.mintA,onChange:u=>p({...f,mintA:u.target.value}),placeholder:"Enter token A mint address",required:!0,disabled:c})]}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!r,children:c?"Creating...":"Create Pool"})})]})]})})]})};async function ot(n,r){try{const o=new j(r,n,{preflightCommitment:"confirmed"}),s=new N(w,o);console.log("catch cash pool");const a=await s.account.pool.all();return console.log("accounts",a),console.log("pool accounts",a[0].account.poolType),a.filter(t=>t.account.poolType==1).map(t=>({poolPk:new h(t.publicKey.toString()),amm:new h(t.account.amm.toString()),mintA:new h(t.account.mintA.toString()),tokenAAmount:t.account.tokenAAmount.toString(),tokenASymbol:"SCASH",displayName:`${t.account.mintA.toString().slice(0,4)}`}))}catch(o){throw console.error("Error fetching cash pool accounts:",o),o}}const rt=({showCreatePool:n=!1,onCreatePool:r})=>{const o=y(),{connection:s}=v(),a=C(),t=K(),[c,i]=g.useState([]),[l,d]=g.useState(!0),f=async()=>{try{if(d(!0),!o)return;const m=await ot(o,s);i(m)}catch(m){console.error("Error fetching pools:",m)}finally{d(!1)}};g.useEffect(()=>{f()},[s,o]);const p=(m,u)=>{u.stopPropagation();const x=t.pathname.split("/")[1];a(`/${x}/${m.poolPk.toString()}`)};return e.jsx("div",{className:"tap-page",children:l?e.jsx("div",{className:"loading-spinner"}):e.jsxs("div",{className:"section",children:[n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"right-location-button",children:e.jsx("button",{className:"button btn-primary",onClick:r,children:"Create Pool"})}),e.jsx("div",{className:"section"})]}),c.length===0?e.jsx("span",{className:"code-text",children:"No pools available"}):c.map(m=>e.jsx("div",{className:"step",children:e.jsxs("div",{className:"row-align-center",children:[e.jsx(ne,{poolInfo:m}),e.jsx("button",{className:"button btn-primary",onClick:u=>p(m,u),children:"Details"})]})},m.poolPk.toString()))]})})},ct=()=>{const n=C();return e.jsx("div",{children:e.jsx(rt,{showCreatePool:!0,onCreatePool:()=>n("/scash/create")})})};async function it(n,r,o,s){try{const a=new j(r,n,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new N(w,a),c=await t.account.pool.fetch(o);let i;try{i=await t.account.amm.fetch(c.amm),console.log("amm",i)}catch(P){console.log("amm",P)}const l=new h(c.mintA),[d]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(S)],t.programId),[f]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(D)],t.programId),[p]=h.findProgramAddressSync([c.amm.toBuffer(),l.toBuffer(),k.Buffer.from(E)],t.programId),[m,u,x,b]=await Promise.all([lt(r,o).catch(()=>!1),W(r,d,p).catch(()=>0),W(r,s,p).catch(()=>0),W(r,s,f).catch(()=>0)]);return console.log("poolAccountAInfo",m),console.log("poolCashAmount",u),console.log("userCashAmount",x),console.log("userSCashAmount",b),{poolStatus:{createPool1:m},poolInfo:{poolPk:o,amm:c.amm,admin:i.admin,mintA:l,tokenASymbol:l.toString().slice(0,4),tokenAIcon:_,tokenAAmount:Number(u)},userAssets:{poolCashAmount:u.toString(),userCashAmount:x.toString(),userSCashAmount:b.toString()}}}catch(a){return console.error("Error getting lending pool details:",a),{poolStatus:{createPool1:!1},poolInfo:{poolPk:new h(o),amm:new h(""),admin:new h(""),mintA:new h(""),tokenAAmount:0},userAssets:{poolCashAmount:"0",userCashAmount:"0",userSCashAmount:"0"}}}}async function W(n,r,o){try{const s=await G(o,r,!0),a=await J(n,s);return Number(a.amount)}catch(s){return console.log("getUserTokenAmount",s),0}}async function lt(n,r){return await n.getAccountInfo(r)!==null}async function dt(n,r,o,s){try{console.log("Executing lendCash...");const a=new j(r,n,{preflightCommitment:"confirmed"}),t=new N(w,a),c=await t.account.pool.fetch(o);console.log("pool.amm",c.amm.toString());const[i]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),k.Buffer.from(S)],t.programId),[l]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),k.Buffer.from(E)],t.programId),[d]=h.findProgramAddressSync([c.amm.toBuffer(),c.mintA.toBuffer(),k.Buffer.from(D)],t.programId),f=await A.token.associatedAddress({mint:l,owner:i}),p=await A.token.associatedAddress({mint:l,owner:a.wallet.publicKey}),m=await A.token.associatedAddress({mint:d,owner:a.wallet.publicKey});return{tx:await t.methods.lendCash(new Z(s)).accounts({mintA:c.mintA,cashPool:o,poolAuthority:i,poolAccountCash:f,cashTokenMint:l,sCashTokenMint:d,lender:a.wallet.publicKey,lenderCashToken:p,lenderScashToken:m,payer:a.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId}).rpc(),accounts:{poolAuthority:i,cashTokenMint:l,lenderCashToken:p}}}catch(a){throw console.error("Error in lendCash:",a),a instanceof Error&&console.error("Error details:",{message:a.message,stack:a.stack}),a}}const mt=({pool:n,onSuccess:r})=>{const o=y(),{connection:s}=v(),[a,t]=g.useState(!1),[c,i]=g.useState(""),[l,d]=g.useState({amountA:""}),f=async p=>{p.preventDefault(),i(""),t(!0);try{const m=parseFloat(l.amountA),u=await dt(o,s,new h((n==null?void 0:n.poolPk)||""),m);r(u.tx),d({amountA:""})}catch(m){console.error("Error depositing liquidity:",m),i(m instanceof Error?m.message:"Failed to deposit liquidity")}finally{t(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:f,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsx("div",{className:"wrapper-header",children:c&&e.jsx("div",{className:"error-message",children:c})}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"input-header",children:"Token A"}),e.jsxs("div",{className:"token-input-section",children:[e.jsxs("div",{className:"token-selector",children:[e.jsx("img",{src:(n==null?void 0:n.tokenAIcon)||_,alt:(n==null?void 0:n.tokenASymbol)||"Token A",className:"token-icon",onError:p=>{p.target.src=_}}),e.jsx("span",{children:n==null?void 0:n.tokenASymbol})]}),e.jsx("input",{type:"number",step:"any",value:l.amountA,onChange:p=>d({...l,amountA:p.target.value}),placeholder:"0.00",required:!0,disabled:a})]})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:a||!o||!l.amountA,children:o?a?"Depositing Liquidity...":"Deposit Liquidity":"Connect Wallet"})]})})})};async function ut(n,r,o){try{console.log("Executing redeemCash...");const s=new j(r,n,{preflightCommitment:"confirmed"}),a=new N(w,s),t=await a.account.pool.fetch(o),[c]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),k.Buffer.from(S)],a.programId),[i]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),k.Buffer.from(E)],a.programId),l=await A.token.associatedAddress({mint:i,owner:c}),[d]=h.findProgramAddressSync([t.amm.toBuffer(),t.mintA.toBuffer(),k.Buffer.from(D)],a.programId),f=await A.token.associatedAddress({mint:i,owner:s.wallet.publicKey}),p=await A.token.associatedAddress({mint:d,owner:s.wallet.publicKey});return{tx:await a.methods.redeemCash().accounts({cashPool:o,poolAuthority:c,poolAccountCash:l,cashTokenMint:i,sCashTokenMint:d,lender:s.wallet.publicKey,lenderCashToken:f,lenderScashToken:p,payer:s.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId}).rpc(),accounts:{poolAuthority:c,cashTokenMint:i,lenderCashToken:f}}}catch(s){throw console.error("Error in redeem:",s),s instanceof Error&&console.error("Error details:",{message:s.message,stack:s.stack}),s}}const pt=({pool:n,poolCashAmount:r,userCashAmount:o,userSCashAmount:s,onSuccess:a})=>{const t=y(),{connection:c}=v(),[i,l]=g.useState(!1),[d,f]=g.useState(""),p=async m=>{m.preventDefault(),f(""),l(!0);try{const u=await ut(t,c,new h(n.poolPk));a(u.tx)}catch(u){console.error("Error depositing liquidity:",u),f(u instanceof Error?u.message:"Failed to deposit liquidity")}finally{l(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("form",{onSubmit:p,children:e.jsxs("div",{className:"wrapper-container",children:[e.jsxs("div",{className:"wrapper-header",children:[e.jsxs("div",{className:"body-text",children:["Deposited  $Cash amount: ",r]}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsxs("div",{className:"body-text",children:["Owned  $Cash amount: ",o]}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsxs("div",{className:"body-text",children:["Owned $SCASH amount: ",s]}),d&&e.jsx("div",{className:"error-message",children:d})]}),e.jsx("button",{type:"submit",className:"button btn-primary",disabled:i||!t||!r,children:t?i?"Withdrawing Liquidity...":"Withdraw Liquidity":"Connect Wallet"})]})})})};async function oe(n,r,o,s){try{const a=new j(r,n,{commitment:"confirmed",preflightCommitment:"confirmed"}),t=new N(w,a),[c]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(Ie)],t.programId),[i]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(S)],t.programId),[l]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(E)],t.programId),[d]=h.findProgramAddressSync([o.toBuffer(),s.toBuffer(),k.Buffer.from(D)],t.programId),f=Q.setComputeUnitLimit({units:1e6});console.log("Step 1: Creating cash pool...");let p="";return await ht(r,c)?console.log("Pool already exists, skipping..."):(p=await t.methods.createCashPool().accounts({amm:o,mintA:s,cashTokenMint:l,cashPool:c,poolAuthority:i,sCashTokenMint:d,admin:q,payer:a.wallet.publicKey,tokenProgram:B,associatedTokenProgram:L,systemProgram:T.programId,rent:z}).preInstructions([f]).rpc({commitment:"confirmed"}),await r.confirmTransaction(p,"confirmed"),console.log("Transaction signature:",p)),{tx1:p}}catch(a){console.error("Error",a)}return{tx1:""}}async function ht(n,r){return await n.getAccountInfo(r)!==null}const ft=({pool:n,onTxSuccess:r,poolStatus:o})=>{const s=y(),{connection:a}=v(),[t,c]=g.useState(!1);if(o===null)return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:e.jsx("div",{className:"wrapper-box",children:e.jsx("div",{className:"align-center",children:"Loading pool status..."})})})});const i=o&&o.createPool1,l=async()=>{try{if(!s){console.error("Wallet not connected");return}if(!n){console.error("Pool not found");return}c(!0);const d=await oe(s,a,n==null?void 0:n.amm,n==null?void 0:n.mintA);r(d.toString())}catch(d){console.error("Error creating pool:",d)}finally{c(!1)}};return e.jsx("div",{className:"wrapper",children:e.jsx("div",{className:"card-container",children:!i&&e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"segmented-progress-bar",children:e.jsx("div",{className:`segment ${o!=null&&o.createPool1?"completed":"pending"}`,title:"Create Pool 1"})})}),e.jsx("div",{className:"step",children:e.jsx("p",{children:"This pool has not initialized completely yet. Click the button below to initialize it."})}),e.jsx("div",{className:"align-center",children:e.jsx("button",{className:"button btn-primary",onClick:l,disabled:t,children:t?"Initializing Pool...":"Initialize Pool"})})]})})})},gt=()=>{const{connection:n}=v(),r=y(),{poolAddress:o}=Y(),s=C(),{publicKey:a}=O(),[t,c]=g.useState(null),[i,l]=g.useState(!1),d=async()=>{try{if(!r)return;l(!0);const f=await it(r,n,new h(o||""),a||new h(""));c(f)}catch(f){console.error("Error fetchDetails",f)}finally{l(!1)}};return g.useEffect(()=>{d()},[o,n,a]),e.jsxs("div",{className:"card-container",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>s("/scash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),se((t==null?void 0:t.poolStatus)||null)?e.jsx("div",{className:"section",children:e.jsx(ft,{pool:(t==null?void 0:t.poolInfo)||null,poolStatus:(t==null?void 0:t.poolStatus)||null,onTxSuccess:d})}):e.jsxs("div",{className:"section",children:[i?e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",children:"Loading prices..."})}):t?e.jsx(e.Fragment,{children:e.jsx("div",{className:"align-center",children:e.jsx("div",{className:"step",children:e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"body-text",children:"Pool TokenA Amount:"}),e.jsx("span",{className:"code-text",children:t==null?void 0:t.poolInfo.tokenAAmount.toFixed(6)})]})})})}):e.jsx("div",{className:"step",children:e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:"Failed to load prices"})}),e.jsx(mt,{pool:(t==null?void 0:t.poolInfo)||null,onSuccess:d}),e.jsx("div",{className:"wrapper"}),i?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"code-text",children:"Loading your cash amount..."})}):t?e.jsx(pt,{pool:(t==null?void 0:t.poolInfo)||null,poolCashAmount:parseFloat(t.userAssets.poolCashAmount),userCashAmount:parseFloat(t.userAssets.userCashAmount),userSCashAmount:parseFloat(t.userAssets.userSCashAmount),onSuccess:d}):e.jsx("div",{className:"error-state",children:e.jsx("div",{className:"code-text",children:"Failed to load your cash amount"})}),(a==null?void 0:a.toBase58())==(t==null?void 0:t.poolInfo.admin.toString())&&e.jsx("div",{className:"step",children:e.jsx("div",{className:"info-row",children:e.jsx("div",{className:"body-text",children:"You are the admin of this pool"})})})]})]})},xt=()=>{const n=C(),r=y(),{connection:o}=v(),{amm:s}=R(),[a,t]=g.useState(""),[c,i]=g.useState(!1),[l,d]=g.useState(""),[f,p]=g.useState({mintA:""}),m=async u=>{if(u.preventDefault(),t(""),d(""),i(!0),!r){t("Please connect your wallet first"),i(!1);return}if(!s){t("Please select an AMM first"),i(!1);return}try{const x=new h(s.pubkey),b=new h(f.mintA),P=await oe(r,o,x,b);d(P.toString()),p({mintA:""}),n("/scash")}catch(x){console.error("Error creating pool:",x),t(x instanceof Error?x.message:"Failed to create pool")}finally{i(!1)}};return e.jsxs("div",{className:"wrapper",children:[e.jsx("div",{className:"back-button-container",children:e.jsx("button",{className:"button btn-primary",onClick:()=>n("/scash"),style:{marginBottom:"var(--spacing-md)"},children:"Back"})}),e.jsx("div",{className:"wrapper-container",children:e.jsxs("div",{className:"wrapper-box",children:[e.jsx("div",{className:"section-title",children:"Create New Pool"}),e.jsx("div",{className:"note-text",children:"Note: Init pool need sign 5 times"}),a&&e.jsx("div",{className:"code-text",style:{color:"var(--error)"},children:a}),l&&e.jsxs("div",{children:[e.jsx("span",{className:"code-text",style:{color:"var(--primary)"},children:"Pool created successfully!"}),e.jsx("a",{href:`https://explorer.solana.com/tx/${l}`,target:"_blank",rel:"noopener noreferrer",className:"code-text",style:{marginLeft:"var(--spacing-xs)"},children:"View transaction"})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"SPONGE Pubkey"}),e.jsx("input",{className:"input",type:"text",value:s?s.pubkey:"",readOnly:!0,disabled:!0})]}),e.jsxs("div",{className:"wrapper-box",children:[e.jsx("span",{className:"sub-title",children:"Token A Mint Address"}),e.jsx("input",{className:"input",type:"text",value:f.mintA,onChange:u=>p({...f,mintA:u.target.value}),placeholder:"Enter token A mint address",required:!0,disabled:c})]}),e.jsx("div",{className:"align-center",children:e.jsx("button",{type:"submit",className:"button btn-primary",disabled:c||!r,children:c?"Creating...":"Create Pool"})})]})]})})]})},kt=()=>e.jsxs("div",{className:"card-container",children:[e.jsx("h1",{className:"title",children:"Welcome to SPONGE Protocol"}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"What is SPONGE Protocol?"}),e.jsx("p",{children:"SPONGE is a decentralized stablecoin protocol for payfi on solana ."})]}),e.jsxs("section",{className:"section",children:[e.jsx("h2",{children:"Key Features"}),e.jsxs("div",{className:"feature",children:[e.jsx("h3",{children:"⚡ ---"}),e.jsx("p",{children:"..."})]})]})]}),yt=[{path:"/",component:Me,children:[{path:"",component:U},{path:"introduction",component:kt,meta:{title:"Introduction"}},{path:"guide",component:U,meta:{title:"Guide"}},{path:"amm",component:$e,meta:{title:"AMM"}},{path:"cash",component:Je,meta:{title:"Cash"}},{path:"cash/create",component:st,meta:{title:"Create Cash Pool"}},{path:"cash/:poolAddress",component:at,meta:{title:"Cash Pool Item"}},{path:"scash",component:ct,meta:{title:"Scash"}},{path:"scash/create",component:xt,meta:{title:"Create Scash Pool"}},{path:"scash/:poolAddress",component:gt,meta:{title:"Scash Pool Item"}}]}];function re(n){return n.map(r=>({path:r.path,element:e.jsx(r.component,{}),children:r.children?re(r.children):void 0}))}const vt=re(yt),H="/SPONGE/assets/favicon-VXsBTfPu.png",bt=()=>{const{connected:n}=O(),{network:r,setNetwork:o}=je(),s=ke(vt);return e.jsxs("div",{className:"app-container",children:[e.jsxs("nav",{className:"app-nav",children:[e.jsxs("div",{className:"brand",children:[e.jsx("img",{src:H,alt:"SPONGE Logo",className:"app-logo"}),e.jsx("h1",{className:"cash-title",children:"SPONGE"})]}),e.jsxs("div",{className:"controls",children:[e.jsx(we,{onChange:o,value:r}),e.jsx(ye,{className:"button btn-primary"})]})]}),e.jsx("main",{className:"app-main",children:n?s:e.jsx("div",{className:"connect-wallet",children:e.jsxs("div",{className:"wrapper",children:[e.jsx("img",{src:H,alt:"SPONGE Logo",className:"connect-logo"}),e.jsx("h2",{className:"section-title",children:"Welcome to SPONGE"}),e.jsx("p",{className:"section-title",children:"Connect your wallet to continue"})]})})}),e.jsxs("div",{className:"social-links-corner",children:[e.jsx("a",{href:"https://github.com/yimingWOW/cash",target:"_blank",rel:"noopener noreferrer",className:"text-link",children:e.jsx("i",{className:"fab fa-github"})}),e.jsx("a",{href:"https://x.com/fall_labs",target:"_blank",rel:"noopener noreferrer",className:"text-link",children:e.jsx("i",{className:"fa-brands fa-x-twitter"})})]})]})},At=()=>e.jsx(Ge,{children:e.jsx(bt,{})});ve.createRoot(document.getElementById("root")).render(e.jsx(be.StrictMode,{children:e.jsx(Ae,{children:e.jsx(Se,{children:e.jsx(At,{})})})}));
